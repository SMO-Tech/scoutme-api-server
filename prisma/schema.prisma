generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// SMO : User
model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  phone     String?
  photoUrl  String?
  UID       String   @unique
  createdAt DateTime @default(now())

  // relationshions
  matchRequest MatchRequest[]
}

enum MatchStatus {
  PENDING
  PROCESSING
  COMPLETED
}

// Match : 
model MatchRequest {
  id          Int         @id @default(autoincrement())
  userId      String
  videoUrl    String
  lineUpImage String?
  status      MatchStatus @default(PENDING) //updated video uploaded it will we on pending mode 
  cratedAt    DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  // relation
  user        User        @relation(fields: [userId], references: [UID])
  players     Player[]

  // relation to analysis
  analysis MatchAnalysis? @relation(name: "MatchAnalysisToMatchRequest")
}

//matchAnalysis
model MatchAnalysis {
  id      Int          @id @default(autoincrement())
  matchId Int          @unique // ensures one-to-one relation
  result  Json // store the analysis result here
  //one to one relationship with mathrequest
  match   MatchRequest @relation(name: "MatchAnalysisToMatchRequest", fields: [matchId], references: [id])
}

// Player 
model Player {
  id             Int          @id @default(autoincrement())
  matchRequestId Int
  name           String
  jerseyNumber   Int
  position       String
  team           String? // optional 'home' or 'away'
  createdAt      DateTime     @default(now())
  //Relation
  matchRequest   MatchRequest @relation(fields: [matchRequestId], references: [id])
}
